{"ast":null,"code":"var _jsxFileName = \"D:\\\\CODE\\\\code\\\\ReactJS\\\\chatapp\\\\src\\\\pages\\\\chatroom\\\\index.jsx\";\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport Moment from \"react-moment\";\nimport { useParams } from \"react-router-dom\";\nimport { urlApiMain, urlWeb } from \"../../utils/url\";\nimport { Auth } from \"../../config\";\n\nconst ChatRoom = () => {\n  const {\n    id\n  } = useParams();\n  const [messages, setMessages] = useState([]);\n  const [sendmessage, setSetmessage] = useState({\n    messages: \"\",\n    image: \"\",\n    receiver: id\n  });\n\n  const getChat = () => {\n    axios.get(urlApiMain + \"getchat\").then(res => {\n      setMessages(res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const onChangeInput = event => {\n    const {\n      name,\n      value\n    } = event.target;\n    setSetmessage({ ...sendmessage,\n      [name]: value\n    });\n  };\n\n  const getFile = () => {\n    document.getElementById(\"fileImage\").click();\n  };\n\n  const getFileMessage = event => {\n    var fileReader = new FileReader();\n    fileReader.readAsDataURL(event.target.files[0]);\n    const {\n      type\n    } = event.target.files[0];\n    console.log(type);\n\n    if (type == \"image/png\" || type == \"image/jpeg\") {\n      fileReader.onload = e => {\n        setSetmessage({ ...sendmessage,\n          [\"image\"]: e.target.result\n        });\n      };\n    } else {\n      alert(\"Image must has extention is png or jpeg.\");\n    }\n  };\n\n  const clearChat = () => {\n    setSetmessage({ ...sendmessage,\n      [\"messages\"]: \"\",\n      [\"image\"]: \"\"\n    });\n  };\n\n  const clearImage = () => {\n    setSetmessage({ ...sendmessage,\n      [\"image\"]: \"\"\n    });\n  };\n\n  const sendMessage = () => {\n    axios.post(urlApiMain + \"sendchat\", sendmessage).then(res => {\n      console.log(res);\n      getChat();\n      clearChat();\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      getChat();\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex justify-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"bg-white md:w-1/2 mt-4 mb-6 rounded shadow-lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"px-6 py-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"font-semibold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, \" \", /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-arrow-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }), \" Chat With By User\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"bg-gray-200 message-height px-3 py-2 overflow-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 11\n    }\n  }, messages.map(message => message.sender == Auth.getTokenAndUserId().userid ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col items-end mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-1/2 px-3 py-2 right-0 rounded-tl-lg rounded-br-lg bg-green-300\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 19\n    }\n  }, message.image === null ? /*#__PURE__*/React.createElement(React.Fragment, null) : /*#__PURE__*/React.createElement(\"img\", {\n    src: urlWeb + \"messages/\" + message.image,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-800\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 21\n    }\n  }, message.messages), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-row w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-700 font-bold text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(Moment, {\n    fromNow: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 25\n    }\n  }, message.created_at)), /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-check mt-1 ml-2 text-blue-800\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 23\n    }\n  })))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col items-start mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-1/2 px-3 py-2 right-0 rounded-tr-lg rounded-bl-lg bg-orange-300\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 19\n    }\n  }, message.image === null ? /*#__PURE__*/React.createElement(React.Fragment, null) : /*#__PURE__*/React.createElement(\"img\", {\n    src: urlWeb + \"messages/\" + message.image,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-800\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 21\n    }\n  }, message.messages), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-700 font-bold text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Moment, {\n    fromNow: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 23\n    }\n  }, message.created_at)))))), sendmessage.image != \"\" ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-row items-center justify-center mt-2 rounded bg-gray-200 px-3 py-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"image-message\",\n    src: sendmessage.image,\n    alt: \"Image File\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: clearImage,\n    className: \"bg-red-600 hover:bg-red-900 text-white ml-2 font-bold px-4 py-3 rounded-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-trash\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 19\n    }\n  })))) : /*#__PURE__*/React.createElement(React.Fragment, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    id: \"text_message\",\n    name: \"messages\",\n    value: sendmessage.messages,\n    onChange: e => onChangeInput(e),\n    className: \"appearance-none w-full bg-gray-200 text-gray-700 border border-gray-200 rounded-full \\r mr-4 py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\",\n    type: \"text\",\n    placeholder: \"Type message here....\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    name: \"image\",\n    onChange: e => getFileMessage(e),\n    id: \"fileImage\",\n    accept: \"image/*\",\n    className: \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: getFile,\n    className: \"bg-green-400 hover:bg-green-700 text-white font-bold px-4 py-3 mr-1 rounded-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-camera\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    id: \"button_send_message\",\n    onClick: sendMessage,\n    className: \"bg-blue-400 hover:bg-blue-700 text-white font-bold px-4 py-3 rounded-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-paper-plane\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 15\n    }\n  }))))));\n};\n\nexport default ChatRoom;","map":{"version":3,"sources":["D:/CODE/code/ReactJS/chatapp/src/pages/chatroom/index.jsx"],"names":["React","useEffect","useState","axios","Moment","useParams","urlApiMain","urlWeb","Auth","ChatRoom","id","messages","setMessages","sendmessage","setSetmessage","image","receiver","getChat","get","then","res","data","catch","err","console","log","onChangeInput","event","name","value","target","getFile","document","getElementById","click","getFileMessage","fileReader","FileReader","readAsDataURL","files","type","onload","e","result","alert","clearChat","clearImage","sendMessage","post","interval","setInterval","clearInterval","map","message","sender","getTokenAndUserId","userid","created_at"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport Moment from \"react-moment\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { urlApiMain, urlWeb } from \"../../utils/url\";\r\nimport { Auth } from \"../../config\";\r\n\r\nconst ChatRoom = () => {\r\n  const { id } = useParams();\r\n  const [messages, setMessages] = useState([]);\r\n  const [sendmessage, setSetmessage] = useState({\r\n    messages: \"\",\r\n    image: \"\",\r\n    receiver: id,\r\n  });\r\n\r\n  const getChat = () => {\r\n    axios\r\n      .get(urlApiMain + \"getchat\")\r\n      .then((res) => {\r\n        setMessages(res.data);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  const onChangeInput = (event) => {\r\n    const { name, value } = event.target;\r\n    setSetmessage({\r\n      ...sendmessage,\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  const getFile = () => {\r\n    document.getElementById(\"fileImage\").click();\r\n  };\r\n\r\n  const getFileMessage = (event) => {\r\n    var fileReader = new FileReader();\r\n    fileReader.readAsDataURL(event.target.files[0]);\r\n    const { type } = event.target.files[0];\r\n    console.log(type);\r\n    if (type == \"image/png\" || type == \"image/jpeg\") {\r\n      fileReader.onload = (e) => {\r\n        setSetmessage({\r\n          ...sendmessage,\r\n          [\"image\"]: e.target.result,\r\n        });\r\n      };\r\n    } else {\r\n      alert(\"Image must has extention is png or jpeg.\");\r\n    }\r\n  };\r\n\r\n  const clearChat = () => {\r\n    setSetmessage({\r\n      ...sendmessage,\r\n      [\"messages\"]: \"\",\r\n      [\"image\"]: \"\",\r\n    });\r\n  };\r\n\r\n  const clearImage = () => {\r\n    setSetmessage({\r\n      ...sendmessage,\r\n      [\"image\"]: \"\",\r\n    });\r\n  };\r\n\r\n  const sendMessage = () => {\r\n    axios\r\n      .post(urlApiMain + \"sendchat\", sendmessage)\r\n      .then((res) => {\r\n        console.log(res);\r\n        getChat();\r\n        clearChat();\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      getChat();\r\n    }, 1000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"flex justify-center\">\r\n      <div className=\"bg-white md:w-1/2 mt-4 mb-6 rounded shadow-lg\">\r\n        <div className=\"px-6 py-6\">\r\n          <h2 className=\"font-semibold\">\r\n            {\" \"}\r\n            <i class=\"fas fa-arrow-left\"></i> Chat With By User\r\n          </h2>\r\n          <div className=\"bg-gray-200 message-height px-3 py-2 overflow-auto\">\r\n            {messages.map((message) =>\r\n              message.sender == Auth.getTokenAndUserId().userid ? (\r\n                <div className=\"flex flex-col items-end mb-3\">\r\n                  <div className=\"w-1/2 px-3 py-2 right-0 rounded-tl-lg rounded-br-lg bg-green-300\">\r\n                    {message.image === null ? (\r\n                      <></>\r\n                    ) : (\r\n                      <img src={urlWeb + \"messages/\" + message.image} />\r\n                    )}\r\n                    <p className=\"text-gray-800\">{message.messages}</p>\r\n                    <div className=\"flex flex-row w-full\">\r\n                      <p className=\"text-gray-700 font-bold text-sm\">\r\n                        <Moment fromNow>{message.created_at}</Moment>\r\n                      </p>\r\n                      <i class=\"fas fa-check mt-1 ml-2 text-blue-800\"></i>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"flex flex-col items-start mb-3\">\r\n                  <div className=\"w-1/2 px-3 py-2 right-0 rounded-tr-lg rounded-bl-lg bg-orange-300\">\r\n                    {message.image === null ? (\r\n                      <></>\r\n                    ) : (\r\n                      <img src={urlWeb + \"messages/\" + message.image} />\r\n                    )}\r\n                    <p className=\"text-gray-800\">{message.messages}</p>\r\n                    <p className=\"text-gray-700 font-bold text-sm\">\r\n                      <Moment fromNow>{message.created_at}</Moment>\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )\r\n            )}\r\n          </div>\r\n          {sendmessage.image != \"\" ? (\r\n            <div className=\"flex flex-row items-center justify-center mt-2 rounded bg-gray-200 px-3 py-2\">\r\n              <div>\r\n                <img\r\n                  className=\"image-message\"\r\n                  src={sendmessage.image}\r\n                  alt=\"Image File\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <button\r\n                  onClick={clearImage}\r\n                  className=\"bg-red-600 hover:bg-red-900 text-white ml-2 font-bold px-4 py-3 rounded-full\"\r\n                >\r\n                  <i class=\"fas fa-trash\"></i>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <></>\r\n          )}\r\n\r\n          <div className=\"flex mt-3\">\r\n            <input\r\n              id=\"text_message\"\r\n              name=\"messages\"\r\n              value={sendmessage.messages}\r\n              onChange={(e) => onChangeInput(e)}\r\n              className=\"appearance-none w-full bg-gray-200 text-gray-700 border border-gray-200 rounded-full \r\n              mr-4 py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\"\r\n              type=\"text\"\r\n              placeholder=\"Type message here....\"\r\n            />\r\n            {/* <!-- Image Button Picker --> */}\r\n            <input\r\n              type=\"file\"\r\n              name=\"image\"\r\n              onChange={(e) => getFileMessage(e)}\r\n              id=\"fileImage\"\r\n              accept=\"image/*\"\r\n              className=\"hidden\"\r\n            />\r\n            <button\r\n              onClick={getFile}\r\n              className=\"bg-green-400 hover:bg-green-700 text-white font-bold px-4 py-3 mr-1 rounded-full\"\r\n            >\r\n              <i class=\"fas fa-camera\"></i>\r\n            </button>\r\n            <button\r\n              id=\"button_send_message\"\r\n              onClick={sendMessage}\r\n              className=\"bg-blue-400 hover:bg-blue-700 text-white font-bold px-4 py-3 rounded-full\"\r\n            >\r\n              <i class=\"fas fa-paper-plane\"></i>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatRoom;\r\n"]},"metadata":{},"sourceType":"module"}