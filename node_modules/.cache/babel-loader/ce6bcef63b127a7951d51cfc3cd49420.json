{"ast":null,"code":"var _jsxFileName = \"D:\\\\CODE\\\\code\\\\ReactJS\\\\chatapp\\\\src\\\\pages\\\\chatroom\\\\index.jsx\";\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport Moment from \"react-moment\";\nimport { useParams } from \"react-router-dom\";\nimport { ReactMic } from \"react-mic\";\nimport { urlApiMain, urlWeb } from \"../../utils/url\";\nimport { Auth } from \"../../config\";\n\nconst ChatRoom = () => {\n  const {\n    id\n  } = useParams();\n  const [recordAudio, setRecordAudio] = useState(false);\n  const [resetAudio, setResetAudio] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [sendmessage, setSetmessage] = useState({\n    messages: \"\",\n    image: \"\",\n    audio: \"\",\n    receiver: id\n  });\n\n  const onDataAudio = recordedBlob => {}; // show / hide audio / message\n\n\n  const showMessageComponent = () => {\n    document.querySelector(\".input-message\").classList.remove(\"hidden\");\n    document.querySelector(\".btn-img-message\").classList.remove(\"hidden\");\n  };\n\n  const hideMessageComponent = () => {\n    document.querySelector(\".input-message\").classList.add(\"hidden\");\n    document.querySelector(\".btn-img-message\").classList.add(\"hidden\");\n  };\n\n  const hideAudioComponent = () => {\n    const previewAudioMessage = document.querySelector(\".preview-audio-message\");\n    previewAudioMessage.classList.add(\"hidden\");\n  };\n\n  const showAudioComponent = () => {\n    const previewAudioMessage = document.querySelector(\".preview-audio-message\");\n    previewAudioMessage.classList.remove(\"hidden\");\n  };\n\n  const startRecordAudio = () => {\n    showAudioComponent();\n    hideMessageComponent();\n    setRecordAudio(true);\n    document.querySelector(\"#button_send_message\").classList.add(\"hidden\");\n  };\n\n  const stopRecordAudio = () => {\n    setResetAudio(true);\n    setRecordAudio(false);\n    document.querySelector(\"#button_send_message\").classList.remove(\"hidden\");\n  };\n\n  const resetRecordAudio = () => {\n    setResetAudio(false);\n    setSetmessage({ ...sendmessage,\n      [\"audio\"]: \"\"\n    });\n    showMessageComponent();\n    hideAudioComponent();\n  };\n\n  const onStopAudio = recordedBlob => {\n    if (!resetAudio) {\n      console.log(\"recordedBlob is: \", recordedBlob.blob);\n      var fileReader = new FileReader();\n      fileReader.readAsDataURL(recordedBlob.blob);\n\n      fileReader.onload = e => {\n        setSetmessage({ ...sendmessage,\n          [\"audio\"]: e.target.result\n        });\n        document.querySelector(\"#button_send_message\").classList.remove(\"hidden\");\n      };\n    } else {\n      setSetmessage({ ...sendmessage,\n        [\"audio\"]: \"\"\n      });\n      setRecordAudio(false);\n    }\n  };\n\n  const getChat = () => {\n    axios.get(`${urlApiMain}getchat/${id}`).then(res => {\n      setMessages(res.data);\n    }).catch(err => {});\n  };\n\n  const getUser = () => {\n    axios.get(`${urlApiMain}getuser/${id}`).then(res => {\n      console.log(res);\n    }).catch(err => {});\n  };\n\n  const onChangeInput = event => {\n    const {\n      name,\n      value\n    } = event.target;\n    setSetmessage({ ...sendmessage,\n      [name]: value\n    });\n  };\n\n  const getFile = () => {\n    document.getElementById(\"fileImage\").click();\n  };\n\n  const getFileMessage = event => {\n    var fileReader = new FileReader();\n    fileReader.readAsDataURL(event.target.files[0]);\n    const {\n      type\n    } = event.target.files[0];\n    console.log(event.target.files[0]);\n\n    if (type == \"image/png\" || type == \"image/jpeg\") {\n      fileReader.onload = e => {\n        setSetmessage({ ...sendmessage,\n          [\"image\"]: e.target.result\n        });\n      };\n    } else {\n      alert(\"Image must has extention is png or jpeg.\");\n    }\n  };\n\n  const clearChat = () => {\n    setSetmessage({ ...sendmessage,\n      [\"messages\"]: \"\",\n      [\"image\"]: \"\"\n    });\n  };\n\n  const clearImage = () => {\n    setSetmessage({ ...sendmessage,\n      [\"image\"]: \"\"\n    });\n  };\n\n  const readMessage = () => {\n    axios.get(`${urlApiMain}readmessage/${id}`).then(res => {}).then(err => {\n      console.log(err);\n    });\n  };\n\n  const sendMessage = () => {\n    axios.post(urlApiMain + \"sendchat\", sendmessage).then(res => {\n      console.log(res);\n      getChat();\n      clearChat();\n      resetRecordAudio(false);\n      showMessageComponent();\n      hideAudioComponent();\n    }).catch(err => {\n      console.log(err);\n    });\n  }; // set permission audio\n\n\n  useEffect(() => {// navigator.getUserMedia(\n    //   { audio: true },\n    //   () => {\n    //     console.log(\"Permission Granted\");\n    //     setIsBlocked(false);\n    //   },\n    //   () => {\n    //     console.log(\"Permission Denied\");\n    //     setIsBlocked(true);\n    //   }\n    // );\n  }, []);\n  useEffect(() => {\n    getUser();\n  }, []);\n  useEffect(() => {\n    const interval = setInterval(() => {\n      readMessage();\n    }, 10000);\n    return () => clearInterval(interval);\n  }, []);\n  useEffect(() => {\n    const interval = setInterval(() => {\n      getChat();\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex justify-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"bg-white md:w-1/2 mt-4 mb-6 rounded shadow-lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"px-6 py-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"font-semibold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-arrow-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"rounded-full img-profil-latest\",\n    src: urlWeb + \"profil/default.jpg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-black\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 17\n    }\n  }, \"User\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-600\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 17\n    }\n  }, \"Online\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"bg-gray-200 message-height px-3 py-2 overflow-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 11\n    }\n  }, messages.map(message => message.sender == Auth.getTokenAndUserId().userid ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col items-end mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-1/2 px-3 py-2 right-0 rounded-tl-lg rounded-br-lg bg-green-300\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 19\n    }\n  }, message.image === null ? /*#__PURE__*/React.createElement(React.Fragment, null) : /*#__PURE__*/React.createElement(\"img\", {\n    src: urlWeb + \"messages/\" + message.image,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 23\n    }\n  }), message.audio === null ? /*#__PURE__*/React.createElement(React.Fragment, null) : /*#__PURE__*/React.createElement(\"audio\", {\n    className: \"w-full\",\n    controls: true,\n    src: urlWeb + \"audios/\" + message.audio,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-800\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 21\n    }\n  }, message.messages), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-row w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-700 font-bold text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(Moment, {\n    fromNow: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 25\n    }\n  }, message.created_at)), message.is_read == \"1\" ? /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-check mt-1 ml-2 text-blue-500\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 25\n    }\n  }) : /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-check mt-1 ml-2 text-gray-500\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 25\n    }\n  })))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col items-start mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-1/2 px-3 py-2 right-0 rounded-tr-lg rounded-bl-lg bg-orange-300\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 19\n    }\n  }, message.image === null ? /*#__PURE__*/React.createElement(React.Fragment, null) : /*#__PURE__*/React.createElement(\"img\", {\n    src: urlWeb + \"messages/\" + message.image,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 23\n    }\n  }), message.audio === null ? /*#__PURE__*/React.createElement(React.Fragment, null) : /*#__PURE__*/React.createElement(\"audio\", {\n    className: \"w-full\",\n    controls: true,\n    src: urlWeb + \"audios/\" + message.audio,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-800\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 21\n    }\n  }, message.messages), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-700 font-bold text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Moment, {\n    fromNow: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 23\n    }\n  }, message.created_at)))))), sendmessage.image != \"\" ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-row items-center justify-center mt-2 rounded bg-gray-200 px-3 py-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"image-message\",\n    src: sendmessage.image,\n    alt: \"Image File\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: clearImage,\n    className: \"bg-red-600 hover:bg-red-900 text-white ml-2 font-bold px-4 py-3 rounded-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-trash\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 19\n    }\n  })))) : /*#__PURE__*/React.createElement(React.Fragment, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 11\n    }\n  }, recordAudio ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: stopRecordAudio,\n    className: \"btn-stop-audio bg-gray-700 hover:bg-gray-700 text-white font-bold px-4 py-3 mr-1 rounded-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 17\n    }\n  }, \"STOP\"), /*#__PURE__*/React.createElement(React.Fragment, null)) : !resetAudio ? /*#__PURE__*/React.createElement(\"button\", {\n    onClick: startRecordAudio,\n    className: \"bg-gray-400 hover:bg-gray-700 text-white font-bold px-4 py-3 mr-1 rounded-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fa fa-microphone\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 17\n    }\n  })) : /*#__PURE__*/React.createElement(React.Fragment, null), resetAudio ? /*#__PURE__*/React.createElement(\"button\", {\n    onClick: resetRecordAudio,\n    className: \"btn-stop-audio bg-red-700 hover:bg-red-700 text-white font-bold px-4 py-3 mr-1 rounded-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 15\n    }\n  }, \"RESET\") : /*#__PURE__*/React.createElement(React.Fragment, null), /*#__PURE__*/React.createElement(ReactMic, {\n    record: recordAudio,\n    className: \"rounded-full hidden preview-audio-message h-audio mr-4\",\n    onStop: onStopAudio,\n    onData: onDataAudio,\n    strokeColor: \"#cbd5e0\",\n    backgroundColor: \"#4a5568\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    id: \"text_message\",\n    name: \"messages\",\n    value: sendmessage.messages,\n    onChange: e => onChangeInput(e),\n    className: \"input-message appearance-none w-full bg-gray-200 text-gray-700 border border-gray-200 rounded-full \\r mr-4 py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\",\n    type: \"text\",\n    placeholder: \"Type message here....\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    name: \"image\",\n    onChange: e => getFileMessage(e),\n    id: \"fileImage\",\n    accept: \"image/*\",\n    className: \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: getFile,\n    className: \"btn-img-message bg-green-400 hover:bg-green-700 text-white font-bold px-4 py-3 mr-1 rounded-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-camera\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    id: \"button_send_message\",\n    onClick: sendMessage,\n    className: \"bg-blue-400 hover:bg-blue-700 text-white font-bold px-4 py-3 rounded-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-paper-plane\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 383,\n      columnNumber: 15\n    }\n  }))))));\n};\n\nexport default ChatRoom;","map":{"version":3,"sources":["D:/CODE/code/ReactJS/chatapp/src/pages/chatroom/index.jsx"],"names":["React","useEffect","useState","axios","Moment","useParams","ReactMic","urlApiMain","urlWeb","Auth","ChatRoom","id","recordAudio","setRecordAudio","resetAudio","setResetAudio","messages","setMessages","sendmessage","setSetmessage","image","audio","receiver","onDataAudio","recordedBlob","showMessageComponent","document","querySelector","classList","remove","hideMessageComponent","add","hideAudioComponent","previewAudioMessage","showAudioComponent","startRecordAudio","stopRecordAudio","resetRecordAudio","onStopAudio","console","log","blob","fileReader","FileReader","readAsDataURL","onload","e","target","result","getChat","get","then","res","data","catch","err","getUser","onChangeInput","event","name","value","getFile","getElementById","click","getFileMessage","files","type","alert","clearChat","clearImage","readMessage","sendMessage","post","interval","setInterval","clearInterval","map","message","sender","getTokenAndUserId","userid","created_at","is_read"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport Moment from \"react-moment\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { ReactMic } from \"react-mic\";\r\nimport { urlApiMain, urlWeb } from \"../../utils/url\";\r\nimport { Auth } from \"../../config\";\r\n\r\nconst ChatRoom = () => {\r\n  const { id } = useParams();\r\n\r\n  const [recordAudio, setRecordAudio] = useState(false);\r\n  const [resetAudio, setResetAudio] = useState(false);\r\n\r\n  const [messages, setMessages] = useState([]);\r\n  const [sendmessage, setSetmessage] = useState({\r\n    messages: \"\",\r\n    image: \"\",\r\n    audio: \"\",\r\n    receiver: id,\r\n  });\r\n\r\n  const onDataAudio = (recordedBlob) => {};\r\n\r\n  // show / hide audio / message\r\n  const showMessageComponent = () => {\r\n    document.querySelector(\".input-message\").classList.remove(\"hidden\");\r\n    document.querySelector(\".btn-img-message\").classList.remove(\"hidden\");\r\n  };\r\n\r\n  const hideMessageComponent = () => {\r\n    document.querySelector(\".input-message\").classList.add(\"hidden\");\r\n    document.querySelector(\".btn-img-message\").classList.add(\"hidden\");\r\n  };\r\n\r\n  const hideAudioComponent = () => {\r\n    const previewAudioMessage = document.querySelector(\r\n      \".preview-audio-message\"\r\n    );\r\n    previewAudioMessage.classList.add(\"hidden\");\r\n  };\r\n\r\n  const showAudioComponent = () => {\r\n    const previewAudioMessage = document.querySelector(\r\n      \".preview-audio-message\"\r\n    );\r\n    previewAudioMessage.classList.remove(\"hidden\");\r\n  };\r\n\r\n  const startRecordAudio = () => {\r\n    showAudioComponent();\r\n    hideMessageComponent();\r\n    setRecordAudio(true);\r\n    document.querySelector(\"#button_send_message\").classList.add(\"hidden\");\r\n  };\r\n\r\n  const stopRecordAudio = () => {\r\n    setResetAudio(true);\r\n    setRecordAudio(false);\r\n    document.querySelector(\"#button_send_message\").classList.remove(\"hidden\");\r\n  };\r\n\r\n  const resetRecordAudio = () => {\r\n    setResetAudio(false);\r\n    setSetmessage({\r\n      ...sendmessage,\r\n      [\"audio\"]: \"\",\r\n    });\r\n    showMessageComponent();\r\n    hideAudioComponent();\r\n  };\r\n\r\n  const onStopAudio = (recordedBlob) => {\r\n    if (!resetAudio) {\r\n      console.log(\"recordedBlob is: \", recordedBlob.blob);\r\n      var fileReader = new FileReader();\r\n      fileReader.readAsDataURL(recordedBlob.blob);\r\n      fileReader.onload = (e) => {\r\n        setSetmessage({\r\n          ...sendmessage,\r\n          [\"audio\"]: e.target.result,\r\n        });\r\n        document\r\n          .querySelector(\"#button_send_message\")\r\n          .classList.remove(\"hidden\");\r\n      };\r\n    } else {\r\n      setSetmessage({\r\n        ...sendmessage,\r\n        [\"audio\"]: \"\",\r\n      });\r\n      setRecordAudio(false);\r\n    }\r\n  };\r\n\r\n  const getChat = () => {\r\n    axios\r\n      .get(`${urlApiMain}getchat/${id}`)\r\n      .then((res) => {\r\n        setMessages(res.data);\r\n      })\r\n      .catch((err) => {});\r\n  };\r\n\r\n  const getUser = () => {\r\n    axios\r\n      .get(`${urlApiMain}getuser/${id}`)\r\n      .then((res) => {\r\n        console.log(res);\r\n      })\r\n      .catch((err) => {});\r\n  };\r\n\r\n  const onChangeInput = (event) => {\r\n    const { name, value } = event.target;\r\n    setSetmessage({\r\n      ...sendmessage,\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  const getFile = () => {\r\n    document.getElementById(\"fileImage\").click();\r\n  };\r\n\r\n  const getFileMessage = (event) => {\r\n    var fileReader = new FileReader();\r\n    fileReader.readAsDataURL(event.target.files[0]);\r\n    const { type } = event.target.files[0];\r\n    console.log(event.target.files[0]);\r\n    if (type == \"image/png\" || type == \"image/jpeg\") {\r\n      fileReader.onload = (e) => {\r\n        setSetmessage({\r\n          ...sendmessage,\r\n          [\"image\"]: e.target.result,\r\n        });\r\n      };\r\n    } else {\r\n      alert(\"Image must has extention is png or jpeg.\");\r\n    }\r\n  };\r\n\r\n  const clearChat = () => {\r\n    setSetmessage({\r\n      ...sendmessage,\r\n      [\"messages\"]: \"\",\r\n      [\"image\"]: \"\",\r\n    });\r\n  };\r\n\r\n  const clearImage = () => {\r\n    setSetmessage({\r\n      ...sendmessage,\r\n      [\"image\"]: \"\",\r\n    });\r\n  };\r\n\r\n  const readMessage = () => {\r\n    axios\r\n      .get(`${urlApiMain}readmessage/${id}`)\r\n      .then((res) => {})\r\n      .then((err) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  const sendMessage = () => {\r\n    axios\r\n      .post(urlApiMain + \"sendchat\", sendmessage)\r\n      .then((res) => {\r\n        console.log(res);\r\n        getChat();\r\n        clearChat();\r\n        resetRecordAudio(false);\r\n        showMessageComponent();\r\n        hideAudioComponent();\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  // set permission audio\r\n  useEffect(() => {\r\n    // navigator.getUserMedia(\r\n    //   { audio: true },\r\n    //   () => {\r\n    //     console.log(\"Permission Granted\");\r\n    //     setIsBlocked(false);\r\n    //   },\r\n    //   () => {\r\n    //     console.log(\"Permission Denied\");\r\n    //     setIsBlocked(true);\r\n    //   }\r\n    // );\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    getUser();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      readMessage();\r\n    }, 10000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      getChat();\r\n    }, 1000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"flex justify-center\">\r\n      <div className=\"bg-white md:w-1/2 mt-4 mb-6 rounded shadow-lg\">\r\n        <div className=\"px-6 py-6\">\r\n          <div className=\"flex\">\r\n            <h2 className=\"font-semibold\">\r\n              <i class=\"fas fa-arrow-left\"></i>\r\n            </h2>\r\n            <div className=\"flex flex-row\">\r\n              <img\r\n                className=\"rounded-full img-profil-latest\"\r\n                src={urlWeb + \"profil/default.jpg\"}\r\n              />\r\n              <div className=\"flex flex-col\">\r\n                <p className=\"text-black\">User</p>\r\n                <p className=\"text-gray-600\">Online</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"bg-gray-200 message-height px-3 py-2 overflow-auto\">\r\n            {messages.map((message) =>\r\n              message.sender == Auth.getTokenAndUserId().userid ? (\r\n                <div className=\"flex flex-col items-end mb-3\">\r\n                  <div className=\"w-1/2 px-3 py-2 right-0 rounded-tl-lg rounded-br-lg bg-green-300\">\r\n                    {message.image === null ? (\r\n                      <></>\r\n                    ) : (\r\n                      <img src={urlWeb + \"messages/\" + message.image} />\r\n                    )}\r\n                    {message.audio === null ? (\r\n                      <></>\r\n                    ) : (\r\n                      <audio\r\n                        className=\"w-full\"\r\n                        controls\r\n                        src={urlWeb + \"audios/\" + message.audio}\r\n                      />\r\n                    )}\r\n                    <p className=\"text-gray-800\">{message.messages}</p>\r\n                    <div className=\"flex flex-row w-full\">\r\n                      <p className=\"text-gray-700 font-bold text-sm\">\r\n                        <Moment fromNow>{message.created_at}</Moment>\r\n                      </p>\r\n                      {message.is_read == \"1\" ? (\r\n                        <i class=\"fas fa-check mt-1 ml-2 text-blue-500\"></i>\r\n                      ) : (\r\n                        <i class=\"fas fa-check mt-1 ml-2 text-gray-500\"></i>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"flex flex-col items-start mb-3\">\r\n                  <div className=\"w-1/2 px-3 py-2 right-0 rounded-tr-lg rounded-bl-lg bg-orange-300\">\r\n                    {message.image === null ? (\r\n                      <></>\r\n                    ) : (\r\n                      <img src={urlWeb + \"messages/\" + message.image} />\r\n                    )}\r\n                    {message.audio === null ? (\r\n                      <></>\r\n                    ) : (\r\n                      <audio\r\n                        className=\"w-full\"\r\n                        controls\r\n                        src={urlWeb + \"audios/\" + message.audio}\r\n                      />\r\n                    )}\r\n                    <p className=\"text-gray-800\">{message.messages}</p>\r\n                    <p className=\"text-gray-700 font-bold text-sm\">\r\n                      <Moment fromNow>{message.created_at}</Moment>\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )\r\n            )}\r\n          </div>\r\n          {sendmessage.image != \"\" ? (\r\n            <div className=\"flex flex-row items-center justify-center mt-2 rounded bg-gray-200 px-3 py-2\">\r\n              <div>\r\n                <img\r\n                  className=\"image-message\"\r\n                  src={sendmessage.image}\r\n                  alt=\"Image File\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <button\r\n                  onClick={clearImage}\r\n                  className=\"bg-red-600 hover:bg-red-900 text-white ml-2 font-bold px-4 py-3 rounded-full\"\r\n                >\r\n                  <i class=\"fas fa-trash\"></i>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <></>\r\n          )}\r\n          <div className=\"flex mt-3\">\r\n            {recordAudio ? (\r\n              <>\r\n                <button\r\n                  onClick={stopRecordAudio}\r\n                  className=\"btn-stop-audio bg-gray-700 hover:bg-gray-700 text-white font-bold px-4 py-3 mr-1 rounded-full\"\r\n                >\r\n                  STOP\r\n                </button>\r\n                <></>\r\n              </>\r\n            ) : !resetAudio ? (\r\n              <button\r\n                onClick={startRecordAudio}\r\n                className=\"bg-gray-400 hover:bg-gray-700 text-white font-bold px-4 py-3 mr-1 rounded-full\"\r\n              >\r\n                <i class=\"fa fa-microphone\"></i>\r\n              </button>\r\n            ) : (\r\n              <></>\r\n            )}\r\n            {resetAudio ? (\r\n              <button\r\n                onClick={resetRecordAudio}\r\n                className=\"btn-stop-audio bg-red-700 hover:bg-red-700 text-white font-bold px-4 py-3 mr-1 rounded-full\"\r\n              >\r\n                RESET\r\n              </button>\r\n            ) : (\r\n              <></>\r\n            )}\r\n            <ReactMic\r\n              record={recordAudio}\r\n              className=\"rounded-full hidden preview-audio-message h-audio mr-4\"\r\n              onStop={onStopAudio}\r\n              onData={onDataAudio}\r\n              strokeColor=\"#cbd5e0\"\r\n              backgroundColor=\"#4a5568\"\r\n            />\r\n            <input\r\n              id=\"text_message\"\r\n              name=\"messages\"\r\n              value={sendmessage.messages}\r\n              onChange={(e) => onChangeInput(e)}\r\n              className=\"input-message appearance-none w-full bg-gray-200 text-gray-700 border border-gray-200 rounded-full \r\n              mr-4 py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\"\r\n              type=\"text\"\r\n              placeholder=\"Type message here....\"\r\n            />\r\n            {/* <!-- Image Button Picker --> */}\r\n            <input\r\n              type=\"file\"\r\n              name=\"image\"\r\n              onChange={(e) => getFileMessage(e)}\r\n              id=\"fileImage\"\r\n              accept=\"image/*\"\r\n              className=\"hidden\"\r\n            />\r\n            <button\r\n              onClick={getFile}\r\n              className=\"btn-img-message bg-green-400 hover:bg-green-700 text-white font-bold px-4 py-3 mr-1 rounded-full\"\r\n            >\r\n              <i className=\"fas fa-camera\"></i>\r\n            </button>\r\n            <button\r\n              id=\"button_send_message\"\r\n              onClick={sendMessage}\r\n              className=\"bg-blue-400 hover:bg-blue-700 text-white font-bold px-4 py-3 rounded-full\"\r\n            >\r\n              <i className=\"fas fa-paper-plane\"></i>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatRoom;\r\n"]},"metadata":{},"sourceType":"module"}